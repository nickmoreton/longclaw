[tox]
skipsdist = True
usedevelop = True
skip_missing_interpreters = True

envlist =
    py{38,39,310}-dj{32}-wt{30}

[gh-actions]
python =
    3.8: py38
    3.9: py39
    3.10: py310

[testenv]
setenv =
    PYTHONPATH = {toxinidir}:{toxinidir}/longclaw

deps =
    coverage
    django-extensions
    django-polymorphic
    django-ipware
    mock
    wagtail-factories

    dj32: Django>=3.2,<3.3
    wt30: wagtail>=3.0,<3.1

install_command = pip install -U {opts} {packages}

commands = 
    coverage run --source longclaw runtests.py
    coverage xml --omit=*/apps.py,*/migrations/*,*/__init__.py,*/gateways/braintree.py,*/gateways/stripe.py,*/bin/longclaw.py

basepython =
    py37: python3.7
